version: '3.8'

services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=file:./dev.db
      - JWT_SECRET=${JWT_SECRET:-your-super-secret-jwt-key-change-in-production}
      - JWT_EXPIRES_IN=24h
      - PORT=3000
    volumes:
      - ./prisma/dev.db:/app/prisma/dev.db
      - ./uploads:/app/uploads
      - ./whatsapp-auth:/app/whatsapp-auth
    restart: always

  frontend:
    build:
      context: .
      dockerfile: Dockerfile.frontend
      args:
        - VITE_API_URL=${VITE_API_URL:-http://localhost:3000/api}
    ports:
      - "8080:80"
    depends_on:
      - backend
    restart: always
